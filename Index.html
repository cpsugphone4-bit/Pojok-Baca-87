<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>üìö Pojok Baca 87</title>
<style>
/* gaya tampilan */
:root{--bg:#0b1220;--fg:#e5e7eb;--muted:#94a3b8;--card:#111827;--primary:#60a5fa;--accent:#22c55e;--warn:#f97316;}
body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#0b1220;color:var(--fg);}
header{background:#111827;padding:14px 16px;display:flex;align-items:center;justify-content:space-between}
header h1{margin:0;font-size:18px}
.container{max-width:1100px;margin:0 auto;padding:16px}
.tabbar{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 16px}
.btn{padding:8px 12px;border:1px solid #223046;background:#1e293b;color:#e5e7eb;border-radius:8px;cursor:pointer;font-weight:600}
.btn.accent{background:#22c55e;color:#fff}
.btn.primary{background:#2563eb;color:#fff}
.btn.warn{background:#f97316;color:#fff}
.section{display:none}
.section.active{display:block}
.input{padding:8px;border-radius:6px;border:1px solid #223046;background:#0f172a;color:#fff;flex:1}
.card{background:#111827;padding:12px;border-radius:12px;margin-bottom:12px}
.results{max-height:350px;overflow:auto}
.item{padding:8px;border-bottom:1px solid #223046;display:flex;justify-content:space-between;align-items:center}
.viewer{width:100%;height:70vh;border:0;border-radius:8px;display:none}
.gallery{display:flex;overflow-x:auto;gap:10px}
.gallery img{height:170px;border-radius:10px}
.history li{margin:6px 0}
</style>
</head>
<body>
<header>
  <h1>üìö Pojok Baca 87</h1>
</header>

<div class="container">
  <div class="tabbar">
    <button class="btn" data-tab="buku">üîé Cari Buku</button>
    <button class="btn" data-tab="timer">‚è± Timer</button>
    <button class="btn" data-tab="riwayat">üìú Riwayat</button>
    <button class="btn" data-tab="galeri">üñº Gallery</button>
  </div>

  <!-- Cari Buku -->
  <section id="buku" class="section active">
    <div class="card">
      <input id="q" class="input" placeholder="Contoh: Matematika Kelas 7"/>
      <button id="btnCari" class="btn accent">Cari</button>
      <div id="results" class="results"></div>
      <iframe id="pdfFrame" class="viewer"></iframe>
    </div>
  </section>

  <!-- Timer -->
  <section id="timer" class="section">
    <div class="card">
      <div id="timeDisp" style="font-size:30px;font-weight:700">00:00</div>
      <button id="tStart" class="btn primary">Mulai</button>
      <button id="tPause" class="btn">Jeda</button>
      <button id="tStop" class="btn warn">Stop & Simpan</button>
    </div>
  </section>

  <!-- Riwayat -->
  <section id="riwayat" class="section">
    <div class="card">
      <ul id="history" class="history"></ul>
      <button id="clearHist" class="btn warn">Hapus Semua</button>
    </div>
  </section>

  <!-- Gallery -->
  <section id="galeri" class="section">
    <div class="card gallery">
      <img src="https://i.postimg.cc/JhP0HkX2/20250819-123403.jpg" alt="gambar1">
      <img src="https://i.postimg.cc/tR1dyqQj/20250819-123536.jpg" alt="gambar2">
    </div>
  </section>
</div>

<script>
// Tab switching
document.querySelectorAll('[data-tab]').forEach(btn=>{
  btn.addEventListener('click',()=>{
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    document.getElementById(btn.dataset.tab).classList.add('active');
  });
});

// Timer
let timer=null, secs=0, currentBook='(Tanpa Judul)';
function showTime(){let m=Math.floor(secs/60),s=secs%60;document.getElementById('timeDisp').textContent=`${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;}
document.getElementById('tStart').onclick=()=>{if(!timer){timer=setInterval(()=>{secs++;showTime();},1000);}};
document.getElementById('tPause').onclick=()=>{clearInterval(timer);timer=null;};
document.getElementById('tStop').onclick=()=>{clearInterval(timer);timer=null;let now=new Date().toLocaleString('id-ID');let hist=JSON.parse(localStorage.getItem('hist87')||'[]');hist.push({title:currentBook,dur:secs,at:now});localStorage.setItem('hist87',JSON.stringify(hist));secs=0;showTime();renderHistory();};
function renderHistory(){let hist=JSON.parse(localStorage.getItem('hist87')||'[]');document.getElementById('history').innerHTML=hist.map((x,i)=>`<li>${x.title} ‚Äî ${Math.floor(x.dur/60)}m ${x.dur%60}s (${x.at}) <button onclick="delHist(${i})">‚ùå</button></li>`).join('')||'Belum ada riwayat';}
function delHist(i){let hist=JSON.parse(localStorage.getItem('hist87')||'[]');hist.splice(i,1);localStorage.setItem('hist87',JSON.stringify(hist));renderHistory();}
document.getElementById('clearHist').onclick=()=>{localStorage.removeItem('hist87');renderHistory();};
renderHistory();

// Cari Buku
async function doSearch(){
  const term=document.getElementById('q').value.trim();
  if(!term) return;
  const res=await fetch('/api/bse?q='+encodeURIComponent(term));
  const data=await res.json();
  let html="";
  if(data.items && data.items.length>0){
    data.items.forEach(it=>{
      html+=`<div class="item"><div><b>${it.title}</b></div>
        <div><button onclick="baca('${encodeURIComponent(it.link)}','${it.title.replace(/'/g,'&#39;')}')">Baca</button>
        <a href="${it.link}" target="_blank">Buka</a></div></div>`;
    });
  }else{html="Tidak ada hasil.";}
  document.getElementById('results').innerHTML=html;
}
document.getElementById('btnCari').onclick=doSearch;
function baca(encUrl,title){const url=decodeURIComponent(encUrl);currentBook=title;const frame=document.getElementById('pdfFrame');frame.src=url;frame.style.display='block';}
</script>
</body>
      </html>
