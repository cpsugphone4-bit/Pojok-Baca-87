<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>üìö Pojok Baca 87</title>
<style>
body{margin:0;font-family:sans-serif;background:#ffffff;color:#111827;line-height:1.6}
header{background:#f3f4f6;padding:16px;text-align:center;box-shadow:0 2px 4px rgba(0,0,0,0.1)}
header h1{margin:0;font-size:22px}
.container{max-width:1000px;margin:20px auto;padding:0 16px}
section{margin-bottom:30px}
.card{background:#f9fafb;border:1px solid #e5e7eb;padding:16px;border-radius:10px;margin-bottom:16px}
.input{padding:8px;border-radius:6px;border:1px solid #d1d5db;width:70%}
.btn{padding:8px 12px;margin:4px;border:none;border-radius:6px;cursor:pointer}
.btn.accent{background:#22c55e;color:#fff}
.btn.primary{background:#2563eb;color:#fff}
.btn.warn{background:#f97316;color:#fff}
.item{padding:8px;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center}
#pdfViewer{width:100%;height:70vh;border:1px solid #d1d5db;border-radius:8px}
.gallery{display:flex;gap:10px;overflow-x:auto}
.gallery img{height:200px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,0.15)}
.history li{margin:6px 0}
</style>
</head>
<body>
<header><h1>üìö Pojok Baca 87</h1></header>
<div class="container">

  <!-- Cari Buku -->
  <section id="buku">
    <h2>üîé Cari Buku</h2>
    <input id="q" class="input" placeholder="Contoh: Matematika Kelas 7"/>
    <button id="btnCari" class="btn accent">Cari</button>
    <div id="results" class="card"></div>
    <iframe id="pdfViewer"></iframe>
  </section>

  <!-- Timer -->
  <section id="timer">
    <h2>‚è± Timer Membaca</h2>
    <div class="card">
      <div id="timeDisp" style="font-size:28px;font-weight:700">00:00</div>
      <button id="tStart" class="btn primary">Mulai</button>
      <button id="tPause" class="btn">Jeda</button>
      <button id="tStop" class="btn warn">Stop & Simpan</button>
    </div>
  </section>

  <!-- Riwayat -->
  <section id="riwayat">
    <h2>üìú Riwayat Membaca</h2>
    <div class="card">
      <ul id="history" class="history"></ul>
      <button id="clearHist" class="btn warn">Hapus Semua</button>
    </div>
  </section>

  <!-- Gallery -->
  <section id="galeri">
    <h2>üñº Gallery</h2>
    <div class="card gallery">
      <img src="https://i.postimg.cc/JhP0HkX2/20250819-123403.jpg" alt="gambar1">
      <img src="https://i.postimg.cc/tR1dyqQj/20250819-123536.jpg" alt="gambar2">
    </div>
  </section>
</div>

<script>
// Timer
let timer=null, secs=0, currentBook='(Tanpa Judul)';
function showTime(){let m=Math.floor(secs/60),s=secs%60;timeDisp.textContent=`${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;}
tStart.onclick=()=>{if(!timer){timer=setInterval(()=>{secs++;showTime();},1000);}};
tPause.onclick=()=>{clearInterval(timer);timer=null;};
tStop.onclick=()=>{clearInterval(timer);timer=null;let now=new Date().toLocaleString('id-ID');let hist=JSON.parse(localStorage.getItem('hist87')||'[]');hist.push({title:currentBook,dur:secs,at:now});localStorage.setItem('hist87',JSON.stringify(hist));secs=0;showTime();renderHistory();};
function renderHistory(){let hist=JSON.parse(localStorage.getItem('hist87')||'[]');history.innerHTML=hist.map((x,i)=>`<li>${x.title} ‚Äî ${Math.floor(x.dur/60)}m ${x.dur%60}s (${x.at}) <button onclick="delHist(${i})">‚ùå</button></li>`).join('')||'Belum ada riwayat';}
function delHist(i){let hist=JSON.parse(localStorage.getItem('hist87')||'[]');hist.splice(i,1);localStorage.setItem('hist87',JSON.stringify(hist));renderHistory();}
clearHist.onclick=()=>{localStorage.removeItem('hist87');renderHistory();};
renderHistory();

// Cari Buku (Google Books API)
btnCari.onclick=async()=>{
  const term=q.value.trim();
  if(!term) return;
  results.innerHTML='Mencari...';
  const res=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(term)}`);
  const data=await res.json();
  let html='';
  if(data.items){
    data.items.forEach(it=>{
      const title=it.volumeInfo.title;
      let link=null;
      if(it.accessInfo && it.accessInfo.pdf && it.accessInfo.pdf.isAvailable && it.accessInfo.pdf.acsTokenLink){
        link=it.accessInfo.pdf.acsTokenLink;
      } else if(it.accessInfo && it.accessInfo.webReaderLink){
        link=it.accessInfo.webReaderLink;
      }
      if(link){
        html+=`<div class="item"><div><b>${title}</b></div>
        <div><button onclick="baca('${encodeURIComponent(link)}','${title.replace(/'/g,'&#39;')}')">Baca</button>
        <a href="${link}" target="_blank">Buka</a></div></div>`;
      }
    });
  }
  results.innerHTML=html||'Tidak ada hasil.';
};

function baca(encUrl,title){
  const url=decodeURIComponent(encUrl);
  currentBook=title;
  pdfViewer.src=`https://docs.google.com/gview?embedded=true&url=${encodeURIComponent(url)}`;
}
</script>
</body>
</html>
